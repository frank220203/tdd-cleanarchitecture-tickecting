# 장애 대응 문서
<details>
<summary><b>장애 개요</b></summary>

- 발생일시: 2024년 8월 22일 15:30 (UTC)
- 장애 지속 시간: 2시간 (15:30 ~ 17:30 UTC)
- 장애 영향: 모든 사용자에게 서비스 제공 중단, 일부 기능 장애

- 장애 증상:
  - 사용자 요청 처리 지연
  - 애플리케이션 응답 타임아웃
  - 서버 CPU 사용률 100% 도달
  - 일부 API 호출 실패 (HTTP 상태 코드 503)
</details>

<details>
<summary><b>원인 분석</b></summary>

- 높은 동시 요청 수:
  - 증상: 애플리케이션 서버가 처리할 수 있는 요청 수를 초과하여 CPU 사용률이 100%에 도달
  - 원인: 급격한 트래픽 증가 또는 비효율적인 요청 처리 로직으로 인해 서버의 CPU 리소스 고갈
- 비효율적인 코드 및 쿼리:
  - 증상: 애플리케이션 로그에 CPU 사용량이 높은 코드 블록 및 비효율적인 데이터베이스 쿼리가 발견.
  - 원인: 비효율적인 루프, 대량의 데이터 처리 또는 복잡한 쿼리로 인해 CPU 리소스의 비정상적인 소모.
- 스레드 및 동시성 문제:
  - 증상: 스레드가 블로킹되거나 대기 상태로 인해 CPU 자원이 비효율적으로 사용됨.
  - 원인: 동시성 문제로 인해 스레드가 적절히 관리되지 않고, CPU 사용률이 증가.
</details>

<details>
<summary><b>장애 대응 과정</b></summary>

- 긴급 대응 조치:
    - 시스템 모니터링: 실시간 모니터링 도구를 사용하여 CPU 사용률 및 애플리케이션 성능 지표 확인.
    - 서버 재시작: CPU 과부하를 일시적으로 완화하기 위해 애플리케이션 서버를 재시작.
    - 부하 분산: 로드 밸런서를 통해 트래픽을 분산시키고, 서버의 부하를 줄임.
- 비효율적인 코드 및 쿼리:
    - 증상: 애플리케이션 로그에 CPU 사용량이 높은 코드 블록 및 비효율적인 데이터베이스 쿼리가 발견.
    - 원인: 비효율적인 루프, 대량의 데이터 처리 또는 복잡한 쿼리로 인해 CPU 리소스의 비정상적인 소모.
- 스레드 및 동시성 문제:
    - 증상: 스레드가 블로킹되거나 대기 상태로 인해 CPU 자원이 비효율적으로 사용됨.
    - 원인: 동시성 문제로 인해 스레드가 적절히 관리되지 않고, CPU 사용률이 증가.
</details>

<details>
<summary><b>재발 방지 대책</b></summary>

- Short-term 대책:
  - 스케일링: 서버의 CPU 및 메모리 자원을 확장하여 트래픽 증가에 대응.
  - 리소스 모니터링 강화: CPU 사용률, 메모리 사용량 등이 일정 기준을 초과했을 경우 담당자에게 알림이 가는 기준치 강화.
- Mid-term 대책:
  - 코드 최적화: 비효율적인 코드 및 쿼리를 분석하여 수정. 예를 들어 Redis를 통해 대기열 및 캐싱 처리.
  - 커뮤니케이션: 장애 발생 및 대응 결과를 고객 및 관련 부서에 공지.
  - 문서화: 장애 대응 과정과 원인 분석 결과를 문서화하여 팀 내 공유.
- Long-term 대책:
  - 성능 테스트 생활화: 정기적인 성능 테스트 및 부하 테스트를 통해 시스템의 처리 능력을 확인하고, 병목 지점을 사전에 발견.
  - 자동 스케일링 설정: 자동 스케일링 정책을 설정하여 서버 자원이 부족할 때 자동으로 인스턴스를 추가. (쿠버네티스 활용)
</details>

[BackToReadMe](../../README.md)